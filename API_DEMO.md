# üöÄ FinanceServer API Demo

## üìñ Demonstra√ß√£o Pr√°tica das Funcionalidades

Este documento demonstra o funcionamento completo das APIs implementadas no FinanceServer.

---

## üîß **Configura√ß√£o Inicial**

### 1. Iniciar o Sistema
```bash
# Iniciar banco de dados e cache
docker-compose up -d postgres redis

# Iniciar backend
cd backend && npm run dev

# Em outro terminal - iniciar frontend
cd frontend && npm run dev
```

### 2. URLs de Acesso
- **Backend API:** http://localhost:3001
- **Frontend:** http://localhost:5173
- **Documenta√ß√£o Swagger:** http://localhost:3001/docs
- **Health Check:** http://localhost:3001/health
- **Health Check Avan√ßado:** http://localhost:3001/health/detailed
- **Performance Metrics:** http://localhost:3001/health/metrics

---

## üß™ **Testes das APIs**

### **üîê 1. Autentica√ß√£o**

#### Registrar Usu√°rio
```bash
curl -X POST http://localhost:3001/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Jo√£o Silva",
    "email": "joao@teste.com",
    "password": "senha123456"
  }'
```

#### Login
```bash
curl -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "joao@teste.com",
    "password": "senha123456"
  }'
```

**Resposta esperada:**
```json
{
  "success": true,
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refreshToken": "...",
    "user": {
      "id": "clxxxxx",
      "name": "Jo√£o Silva",
      "email": "joao@teste.com"
    }
  }
}
```

**üîë Guardar o token para as pr√≥ximas requisi√ß√µes!**

---

### **üè¶ 2. API de Contas (Accounts)**

#### Criar Conta
```bash
curl -X POST http://localhost:3001/api/accounts \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer SEU_TOKEN_AQUI" \
  -d '{
    "name": "Conta Corrente Banco do Brasil",
    "type": "CHECKING",
    "balance": "5000.00",
    "currency": "BRL",
    "description": "Conta principal para movimenta√ß√µes"
  }'
```

#### Listar Contas
```bash
curl -X GET http://localhost:3001/api/accounts \
  -H "Authorization: Bearer SEU_TOKEN_AQUI"
```

#### Obter Resumo das Contas
```bash
curl -X GET http://localhost:3001/api/accounts/summary \
  -H "Authorization: Bearer SEU_TOKEN_AQUI"
```

---

### **üè∑Ô∏è 3. API de Categorias (Categories)**

#### Listar Categorias (Sistema + Usu√°rio)
```bash
curl -X GET http://localhost:3001/api/categories \
  -H "Authorization: Bearer SEU_TOKEN_AQUI"
```

#### Criar Categoria Personalizada
```bash
curl -X POST http://localhost:3001/api/categories \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer SEU_TOKEN_AQUI" \
  -d '{
    "name": "Freelances",
    "type": "INCOME",
    "description": "Renda de trabalhos freelance",
    "color": "#10B981",
    "icon": "üíº"
  }'
```

#### Obter Estat√≠sticas de Uso
```bash
curl -X GET "http://localhost:3001/api/categories/usage?startDate=2024-01-01&endDate=2024-12-31" \
  -H "Authorization: Bearer SEU_TOKEN_AQUI"
```

---

### **üí∞ 4. API de Transa√ß√µes (Transactions)**

#### Criar Transa√ß√£o de Receita
```bash
curl -X POST http://localhost:3001/api/transactions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer SEU_TOKEN_AQUI" \
  -d '{
    "description": "Sal√°rio Janeiro 2024",
    "amount": "5500.00",
    "type": "INCOME",
    "categoryId": "ID_DA_CATEGORIA",
    "accountId": "ID_DA_CONTA",
    "date": "2024-01-05"
  }'
```

#### Criar Transa√ß√£o de Despesa
```bash
curl -X POST http://localhost:3001/api/transactions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer SEU_TOKEN_AQUI" \
  -d '{
    "description": "Supermercado",
    "amount": "-350.00",
    "type": "EXPENSE",
    "categoryId": "ID_DA_CATEGORIA",
    "accountId": "ID_DA_CONTA",
    "date": "2024-01-06"
  }'
```

#### Obter Analytics de Transa√ß√µes
```bash
curl -X GET "http://localhost:3001/api/transactions/analytics?period=monthly&year=2024" \
  -H "Authorization: Bearer SEU_TOKEN_AQUI"
```

---

### **üéØ 5. API de Metas (Goals)**

#### Criar Meta Financeira
```bash
curl -X POST http://localhost:3001/api/goals \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer SEU_TOKEN_AQUI" \
  -d '{
    "title": "Viagem para Europa",
    "description": "Juntar dinheiro para viagem de 15 dias",
    "targetAmount": 15000.00,
    "currentAmount": 2000.00,
    "deadline": "2024-12-31",
    "category": "Viagem",
    "color": "#3B82F6"
  }'
```

#### Contribuir para Meta
```bash
curl -X POST http://localhost:3001/api/goals/ID_DA_META/contribute \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer SEU_TOKEN_AQUI" \
  -d '{
    "amount": 500.00
  }'
```

#### Obter Progresso Detalhado
```bash
curl -X GET http://localhost:3001/api/goals/ID_DA_META/progress \
  -H "Authorization: Bearer SEU_TOKEN_AQUI"
```

---

### **üíµ 6. API de Or√ßamentos (Budgets)**

#### Criar Or√ßamento Mensal
```bash
curl -X POST http://localhost:3001/api/budgets \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer SEU_TOKEN_AQUI" \
  -d '{
    "name": "Or√ßamento Alimenta√ß√£o Janeiro",
    "description": "Limite de gastos com alimenta√ß√£o",
    "amount": 800.00,
    "period": "MONTHLY",
    "startDate": "2024-01-01",
    "endDate": "2024-01-31",
    "categoryId": "ID_CATEGORIA_ALIMENTACAO",
    "color": "#F59E0B"
  }'
```

#### Verificar Alertas do Or√ßamento
```bash
curl -X GET http://localhost:3001/api/budgets/ID_DO_ORCAMENTO/alerts \
  -H "Authorization: Bearer SEU_TOKEN_AQUI"
```

#### Obter Analytics de Or√ßamentos
```bash
curl -X GET "http://localhost:3001/api/budgets/analytics?startDate=2024-01-01&endDate=2024-12-31" \
  -H "Authorization: Bearer SEU_TOKEN_AQUI"
```

---

## üìä **Exemplos de Respostas**

### Resumo de Contas
```json
{
  "success": true,
  "data": {
    "summary": {
      "totalAccounts": 3,
      "totalBalance": 12500.50,
      "activeAccounts": 3,
      "accountsByType": {
        "CHECKING": 1,
        "SAVINGS": 1,
        "INVESTMENT": 1
      }
    },
    "accounts": [...]
  }
}
```

### Progresso de Meta
```json
{
  "success": true,
  "data": {
    "goalId": "clxxxxx",
    "title": "Viagem para Europa",
    "financial": {
      "current": 2500.00,
      "target": 15000.00,
      "remaining": 12500.00,
      "percentage": 16.67,
      "isCompleted": false
    },
    "time": {
      "totalDays": 365,
      "daysPassed": 30,
      "daysRemaining": 335,
      "timePercentage": 8.22,
      "isOverdue": false
    },
    "recommendations": {
      "dailyTarget": 37.31,
      "onTrack": true
    }
  }
}
```

### Alertas de Or√ßamento
```json
{
  "success": true,
  "data": {
    "budgetId": "clxxxxx",
    "alerts": [
      {
        "type": "WARNING",
        "severity": "medium",
        "message": "Aten√ß√£o: 90% do or√ßamento atingido",
        "details": "Restam apenas R$ 80,00 do seu or√ßamento"
      }
    ],
    "currentStatus": {
      "spent": 720.00,
      "budget": 800.00,
      "progress": 90.0,
      "daysRemaining": 5
    }
  }
}
```

---

## üé® **Frontend Services**

### Usando os Services no Frontend

```typescript
import {
  accountsService,
  categoriesService,
  goalsService,
  budgetsService
} from '@/services'

// Exemplo: Criar conta
const createAccount = async () => {
  try {
    const response = await accountsService.createAccount({
      name: "Conta Poupan√ßa",
      type: "SAVINGS",
      balance: "1000.00"
    })
    console.log("Conta criada:", response.data)
  } catch (error) {
    console.error("Erro:", error)
  }
}

// Exemplo: Listar metas
const loadGoals = async () => {
  try {
    const response = await goalsService.getGoals()
    console.log("Metas:", response.data.goals)
  } catch (error) {
    console.error("Erro:", error)
  }
}
```

---

## üìä **8. API de Dashboard (Dashboard)**

#### Obter Vis√£o Geral Financeira Completa
```bash
curl -X GET "http://localhost:3001/api/dashboard/overview?period=30" \
  -H "Authorization: Bearer SEU_TOKEN_AQUI"
```

#### Obter Estat√≠sticas R√°pidas
```bash
curl -X GET http://localhost:3001/api/dashboard/quick-stats \
  -H "Authorization: Bearer SEU_TOKEN_AQUI"
```

#### Testar API Dashboard
```bash
curl -X GET http://localhost:3001/api/dashboard/test
```

**Resposta esperada (Overview):**
```json
{
  "success": true,
  "data": {
    "period": { "days": 30, "startDate": "...", "endDate": "..." },
    "financial": {
      "totalBalance": 12500.50,
      "totalIncome": 8500.00,
      "totalExpenses": 5200.30,
      "netIncome": 3299.70,
      "expenseTrend": { "percentage": -5.2, "direction": "DOWN" }
    },
    "analytics": {
      "topExpenseCategories": [...],
      "financialHealth": {
        "score": 78,
        "recommendations": [...]
      }
    }
  }
}
```

---

## üîç **9. Monitoramento e Health Checks**

#### Health Check B√°sico
```bash
curl -X GET http://localhost:3001/health
```

#### Health Check Detalhado
```bash
curl -X GET http://localhost:3001/health/detailed
```

#### M√©tricas de Performance
```bash
curl -X GET http://localhost:3001/health/metrics
```

#### Readiness Probe (Kubernetes)
```bash
curl -X GET http://localhost:3001/health/ready
```

#### Liveness Probe (Kubernetes)
```bash
curl -X GET http://localhost:3001/health/alive
```

---

## ‚úÖ **Funcionalidades Implementadas e Testadas**

### Core Features
- ‚úÖ **Autentica√ß√£o JWT** completa com refresh tokens
- ‚úÖ **CRUD de Contas** com valida√ß√µes e resumos
- ‚úÖ **Categorias sistema + usu√°rio** com estat√≠sticas de uso
- ‚úÖ **Transa√ß√µes** com analytics avan√ßadas e filtros
- ‚úÖ **Metas financeiras** com progresso e contribui√ß√µes
- ‚úÖ **Or√ßamentos** com alertas inteligentes e analytics
- ‚úÖ **Dashboard** com vis√£o geral e health scoring
- ‚úÖ **Cache Redis** para performance otimizada
- ‚úÖ **Valida√ß√£o de dados** em todos endpoints
- ‚úÖ **Tratamento de erros** padronizado e estruturado

### Advanced Features
- ‚úÖ **Rate Limiting Avan√ßado** por tipo de opera√ß√£o
- ‚úÖ **Logging Estruturado** com Winston e rota√ß√£o de logs
- ‚úÖ **Health Checks Avan√ßados** para todos os servi√ßos
- ‚úÖ **M√©tricas de Performance** em tempo real
- ‚úÖ **Auditoria completa** de opera√ß√µes financeiras
- ‚úÖ **Sliding Window Rate Limiting** com Redis
- ‚úÖ **Documenta√ß√£o Swagger** autom√°tica e completa
- ‚úÖ **Frontend Services** para todas as APIs
- ‚úÖ **Error Fingerprinting** para deduplica√ß√£o
- ‚úÖ **Graceful Shutdown** com cleanup de recursos

### Security & Monitoring
- ‚úÖ **JWT com blacklist** no Redis
- ‚úÖ **Rate limiting por IP, usu√°rio e opera√ß√£o**
- ‚úÖ **Logs de auditoria** para compliance
- ‚úÖ **Monitoramento de sa√∫de** do sistema
- ‚úÖ **M√©tricas de performance** detalhadas
- ‚úÖ **Detec√ß√£o de anomalias** financeiras
- ‚úÖ **Backup de logs** com rota√ß√£o autom√°tica

---

## üöÄ **Sistema Enterprise-Ready!**

O FinanceServer est√° pronto para uso em produ√ß√£o com:

### üèóÔ∏è Arquitetura
- **Clean Architecture** com Domain-Driven Design
- **Dependency Injection** com TypeDI
- **Repository Pattern** com Prisma ORM
- **Service Layer** bem definido
- **Middleware pipeline** configur√°vel

### üîí Seguran√ßa
- **Rate Limiting** multi-camada
- **JWT Authentication** com refresh tokens
- **Input Validation** completa
- **SQL Injection** preven√ß√£o com Prisma
- **CORS** configurado corretamente

### üìä Observabilidade
- **Structured Logging** com n√≠veis
- **Health Checks** para todos servi√ßos
- **Performance Metrics** detalhadas
- **Error Tracking** com fingerprints
- **Audit Trails** completos

### ‚ö° Performance
- **Redis Caching** estrat√©gico
- **Connection Pooling** otimizado
- **Query Optimization** com √≠ndices
- **Sliding Window** rate limiting
- **Graceful Degradation** em falhas

### üì± Frontend Ready
- **TypeScript Services** completos
- **Type Safety** end-to-end
- **Error Handling** padronizado
- **API Consistency** garantida